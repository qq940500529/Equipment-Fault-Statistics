# 常见问题 (FAQ)

本页面收集了用户和开发者最常遇到的问题及解决方案。

## 使用相关

### 文件上传问题

#### Q: 支持哪些文件格式？

**A**: 系统支持以下Excel格式：
- `.xlsx` (Excel 2007及更高版本)
- `.xls` (Excel 97-2003)

不支持其他格式（如CSV、TXT等）。如果您有CSV文件，请先在Excel中打开并另存为.xlsx格式。

#### Q: 文件大小有限制吗？

**A**: 是的，文件大小限制为 **50MB**。

如果您的文件超过此限制：
1. 将数据分成多个较小的文件
2. 删除不必要的列或行
3. 清除Excel中的格式和图片

#### Q: 为什么上传文件后没有反应？

**可能原因**:
1. 文件格式不支持
2. 文件已损坏
3. 文件有密码保护
4. 浏览器不兼容

**解决方法**:
1. 确认文件格式为.xlsx或.xls
2. 尝试在Excel中打开文件确认完整性
3. 移除密码保护
4. 更换浏览器（推荐Chrome/Edge/Firefox最新版）

### 数据验证问题

#### Q: 提示"缺少必需列"怎么办？

**A**: 检查您的Excel文件是否包含以下必需列：
- 工单号
- 车间
- 维修人
- 报修时间
- 维修开始时间
- 维修结束时间

**注意**: 列名必须完全匹配（区分中英文和大小写）。

#### Q: 日期格式错误如何解决？

**A**: 确保时间列的格式正确：

**支持的格式**:
- `2024-01-01 08:00:00`
- `2024/01/01 08:00`
- Excel日期格式（通过"设置单元格格式"设置为日期）

**常见错误**:
- 文本格式的日期：在Excel中转换为日期格式
- 空白单元格：填充完整的日期数据
- 错误的日期值：检查并修正

#### Q: 为什么有些数据被标记为警告？

**A**: 警告不会阻止处理，但提示可能的问题：

**常见警告**:
- 车间列不包含区域信息（如"一车间"而非"一车间-A区"）
- 维修人不在预定义名单中
- 时间顺序异常（如维修结束时间早于开始时间）

这些数据仍会被处理，但请检查是否符合预期。

### 数据处理问题

#### Q: 为什么处理后的行数减少了？

**A**: 系统会自动删除以下行：
1. 车间列值为"合计"的行
2. 时间数据不完整的行（缺少报修/开始/结束时间）
3. 时间数据无效的行（日期格式错误）

查看"处理统计"了解具体删除的行数。

#### Q: 车间和区域是如何分列的？

**A**: 系统按"-"符号分割车间列：
- 输入: `"一车间-A区"`
- 输出: 车间=`"一车间"`, 区域=`"A区"`

如果车间列不包含"-"，则：
- 车间保持原值
- 区域为空

#### Q: 维修人分类的依据是什么？

**A**: 根据预定义的人员名单：

**维修工** (16人):
王兴森、孙长青、徐阴海、任扶民、吴长振、张玉柱、刘志强、杨明印、张金华、刘金财、崔树立、杨致敬、马圣强、刘子凯、何洪杰、刘佳文

**电工** (14人):
李润海、赵艳伟、吴霄、吴忠建、李之彦、宋桂良、崔金辉、李瑞召、万庆权、郭瑞臣、郭兆勤、赵同宽、肖木凯、赵燕伟

**未知**: 不在以上名单中的人员

详见 [维修人员名单](维修人员名单)

#### Q: 时间是如何计算的？

**A**: 时间计算公式：
- **等待时间** = 维修开始时间 - 报修时间
- **维修时间** = 维修结束时间 - 维修开始时间
- **故障时间** = 等待时间 + 维修时间

所有时间以**小时**为单位，保留**2位小数**。

### 数据导出问题

#### Q: 导出的Excel文件在哪里？

**A**: 文件会自动下载到浏览器的默认下载目录（通常是"下载"文件夹）。

#### Q: 导出的CSV文件乱码怎么办？

**A**: CSV文件使用UTF-8编码（带BOM）。

如果在Excel中打开出现乱码：
1. 不要直接双击打开CSV
2. 在Excel中选择"数据" → "从文本/CSV"
3. 选择文件并确认编码为UTF-8
4. 导入数据

或者直接使用导出的Excel格式。

#### Q: 可以同时导出多种格式吗？

**A**: 可以！处理完成后，您可以分别点击不同格式的导出按钮。

## 技术相关

### 浏览器兼容性

#### Q: 支持哪些浏览器？

**A**: 推荐使用以下浏览器：
- Chrome/Edge 90+
- Firefox 88+
- Safari 14+

不支持IE浏览器。

#### Q: 为什么在旧浏览器中无法使用？

**A**: 系统使用了ES6+的JavaScript特性，旧浏览器不支持。

**解决方法**: 更新浏览器到最新版本。

### 性能问题

#### Q: 处理大文件时页面卡顿怎么办？

**A**: 这是正常现象，因为所有处理都在浏览器中进行。

**建议**:
- 处理大文件时请耐心等待
- 关闭其他浏览器标签释放内存
- 如果文件特别大（>10000行），考虑分批处理

#### Q: 系统能处理多大的文件？

**A**: 理论上：
- < 1,000行：瞬间完成
- 1,000 - 10,000行：几秒钟
- 10,000 - 100,000行：可能需要几十秒
- > 100,000行：建议分批处理

实际性能取决于您的电脑配置。

### 数据安全

#### Q: 我的数据会上传到服务器吗？

**A**: **不会！** 所有数据处理完全在您的浏览器中进行。

系统特点：
- ✅ 纯前端应用
- ✅ 数据不离开您的电脑
- ✅ 可以离线使用
- ✅ 无需网络连接

#### Q: 可以在没有网络的环境使用吗？

**A**: **可以！** 

1. 下载完整的项目文件
2. 直接打开index.html
3. 无需任何服务器或网络连接

### 离线使用

#### Q: 如何下载离线版本？

**A**: 两种方式：

**方式1: Git克隆**
```bash
git clone https://github.com/qq940500529/Equipment-Fault-Statistics.git
```

**方式2: 下载ZIP**
1. 访问GitHub项目页面
2. 点击"Code" → "Download ZIP"
3. 解压文件
4. 双击index.html使用

## 开发相关

### 二次开发

#### Q: 可以基于此项目进行二次开发吗？

**A**: **可以！** 本项目采用MIT许可证，允许：
- ✅ 商业使用
- ✅ 修改
- ✅ 分发
- ✅ 私有使用

请保留原始许可证和版权声明。

#### Q: 如何添加新的维修人员？

**A**: 编辑 `js/config/constants.js` 文件：

```javascript
export const REPAIR_WORKERS = [
  '王兴森', '孙长青', // ... 现有人员
  '新维修工姓名'  // 添加新人员
];

export const ELECTRICIANS = [
  '李润海', '赵艳伟', // ... 现有人员
  '新电工姓名'  // 添加新人员
];
```

#### Q: 如何自定义列名？

**A**: 编辑 `js/config/constants.js` 中的 `COLUMN_NAMES` 对象：

```javascript
export const COLUMN_NAMES = {
  workOrder: ['工单号', 'Work Order', '您的自定义列名'],
  // ... 其他列
};
```

#### Q: 如何贡献代码？

**A**: 请查看 [贡献指南](贡献指南) 了解详细流程。

简要步骤：
1. Fork项目
2. 创建功能分支
3. 提交更改
4. 创建Pull Request

## 错误排查

### 常见错误信息

#### "不支持的文件格式"

**原因**: 文件不是.xlsx或.xls格式  
**解决**: 使用Excel另存为.xlsx格式

#### "文件大小超过限制"

**原因**: 文件超过50MB  
**解决**: 分割文件或删除不必要的数据

#### "缺少必需列"

**原因**: Excel文件缺少必需的列  
**解决**: 确保包含所有必需列（工单号、车间、维修人、三个时间列）

#### "日期格式无效"

**原因**: 时间列不是有效的日期格式  
**解决**: 在Excel中将单元格格式设置为日期

### 调试技巧

#### Q: 如何查看详细的错误信息？

**A**: 打开浏览器开发者工具：
- Chrome/Edge: 按F12或Ctrl+Shift+I
- Firefox: 按F12或Ctrl+Shift+I
- Safari: Cmd+Option+I

查看Console标签页的错误消息。

## 其他问题

### Q: 找不到我需要的功能怎么办？

**A**: 
1. 查看 [使用指南](使用指南) 了解所有功能
2. 在 [Issues](https://github.com/qq940500529/Equipment-Fault-Statistics/issues) 中搜索
3. 提交 [功能请求](https://github.com/qq940500529/Equipment-Fault-Statistics/issues/new?template=feature_request.md)

### Q: 如何获取帮助？

**A**: 多种方式：
- 📖 查看本Wiki文档
- 💬 在 [Discussions](https://github.com/qq940500529/Equipment-Fault-Statistics/discussions) 提问
- 🐛 报告 [Issue](https://github.com/qq940500529/Equipment-Fault-Statistics/issues)

### Q: 项目还在开发中吗？

**A**: 是的！查看 [路线图](路线图) 了解开发计划。

当前状态：
- ✅ Phase 1-4: 已完成
- 🔄 Phase 5: 进行中
- 📋 Phase 6-9: 计划中

---

**没有找到答案？**

- 💬 [提问讨论](https://github.com/qq940500529/Equipment-Fault-Statistics/discussions)
- 📧 联系项目维护者
