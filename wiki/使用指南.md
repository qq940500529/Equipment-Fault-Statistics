# 使用指南

完整的系统使用说明，帮助您充分利用设备故障统计系统的所有功能。

## 系统概述

设备故障统计系统是一个纯前端的数据处理工具，用于：
- 处理设备维修记录的Excel数据
- 自动清洗和转换数据
- 生成统计分析
- 导出处理后的数据

## 完整使用流程

### 第一步：准备Excel文件

#### 文件格式要求

**支持的格式**:
- `.xlsx` (Excel 2007及更高版本) ✅
- `.xls` (Excel 97-2003) ✅

**文件大小**: 最大 50MB

#### 必需的列

您的Excel文件必须包含以下列（列名可以是中文或英文）：

| 列名 | 必需 | 说明 | 示例 |
|-----|-----|------|------|
| 工单号 | ✅ | 唯一标识 | WO20240101001 |
| 车间 | ✅ | 车间名称（可包含区域） | 一车间-A区 |
| 维修人 | ✅ | 维修人员姓名 | 张三 |
| 报修时间 | ✅ | 报修时间 | 2024-01-01 08:00:00 |
| 维修开始时间 | ✅ | 维修开始时间 | 2024-01-01 09:30:00 |
| 维修结束时间 | ✅ | 维修结束时间 | 2024-01-01 11:00:00 |

**可选的列**（如果不存在，系统会自动创建）:
- 区域
- 维修人分类
- 等待时间h
- 维修时间h
- 故障时间h

#### 数据格式要求

**时间格式**:
- `2024-01-01 08:00:00` (推荐)
- `2024/01/01 08:00`
- Excel标准日期格式

**车间格式**:
- 包含区域: `"一车间-A区"` (推荐)
- 不含区域: `"一车间"` (也可以)

**示例数据**:

| 工单号 | 车间 | 维修人 | 报修时间 | 维修开始时间 | 维修结束时间 |
|-------|------|--------|----------|------------|-------------|
| WO001 | 一车间-A区 | 王兴森 | 2024-01-01 08:00:00 | 2024-01-01 09:30:00 | 2024-01-01 11:00:00 |
| WO002 | 二车间-B区 | 李润海 | 2024-01-01 10:00:00 | 2024-01-01 10:15:00 | 2024-01-01 11:30:00 |

### 第二步：上传文件

#### 上传方式

**方式1: 拖拽上传** (推荐)
1. 打开应用
2. 将Excel文件拖拽到上传区域
3. 松开鼠标

**方式2: 点击选择**
1. 点击上传区域
2. 在文件选择对话框中选择Excel文件
3. 点击"打开"

#### 上传过程

上传后系统会：
1. ✅ 验证文件类型
2. ✅ 检查文件大小
3. ✅ 读取文件内容
4. ✅ 显示上传成功消息

**可能的错误**:
- "不支持的文件格式" → 使用.xlsx或.xls格式
- "文件大小超过限制" → 文件需小于50MB
- "文件读取失败" → 检查文件是否损坏

### 第三步：预览和验证数据

#### 数据统计信息

上传成功后，会显示：
- **总行数**: Excel文件中的数据行数
- **总列数**: 列的数量
- **数据范围**: 数据的起止行号

#### 数据预览

系统会显示**前50行**数据，您可以：
- 检查数据是否正确加载
- 确认列名识别正确
- 查看数据格式

#### 数据验证

系统自动进行验证：

**验证项目**:
- ✅ 必需列完整性检查
- ✅ 数据类型验证
- ✅ 日期格式验证
- ✅ 空值检测

**验证结果**:

**✅ 通过**: 显示绿色成功消息
```
验证通过！
- 总行数: 100
- 有效行数: 95
- 错误: 0
- 警告: 5
```

**❌ 失败**: 显示红色错误消息和具体问题
```
验证失败！
错误:
- 第5行: 报修时间格式无效
- 第10行: 缺少维修开始时间

警告:
- 第15行: 车间列不包含区域信息
```

### 第四步：处理数据

#### 开始处理

点击"开始处理"按钮，系统会自动执行以下操作：

#### 处理步骤

**1. 删除"合计"行**
- 识别车间列值为"合计"的行
- 自动删除这些汇总行
- 统计删除的行数

**2. 车间列分列**
- 检测车间列是否包含"-"分隔符
- 分割为"车间"和"区域"两列
- 示例: "一车间-A区" → 车间="一车间", 区域="A区"

**3. 维修人分类**
- 根据预定义名单自动分类
- 维修工: 16人 (如王兴森、孙长青等)
- 电工: 14人 (如李润海、赵艳伟等)
- 未知: 不在名单中的人员

详见 [维修人员名单](维修人员名单)

**4. 时间计算**

自动计算三个时间字段（单位：小时，保留2位小数）:

- **等待时间** = 维修开始时间 - 报修时间
  ```
  报修: 08:00:00
  开始: 09:30:00
  等待: 1.50小时
  ```

- **维修时间** = 维修结束时间 - 维修开始时间
  ```
  开始: 09:30:00
  结束: 11:00:00
  维修: 1.50小时
  ```

- **故障时间** = 等待时间 + 维修时间
  ```
  等待: 1.50小时
  维修: 1.50小时
  故障: 3.00小时
  ```

**5. 删除不完整行**
- 检查时间字段完整性
- 删除缺少任一时间字段的行
- 删除时间格式无效的行

#### 处理进度

处理过程中会显示：
- 实时进度条
- 当前处理步骤
- 预计剩余时间（大文件）

#### 处理统计

处理完成后显示：
```
处理完成！
━━━━━━━━━━━━━━━━━━
原始行数: 100
处理后行数: 85
━━━━━━━━━━━━━━━━━━
删除的合计行: 5
删除的不完整行: 10
━━━━━━━━━━━━━━━━━━
有效数据率: 85.00%
```

### 第五步：查看结果

#### 结果预览

处理完成后，可以查看：
- **数据表格**: 处理后的数据（前50行）
- **统计卡片**: 各项处理统计
- **数据摘要**: 关键指标汇总

#### 结果验证

建议检查：
- ✅ 行数是否合理
- ✅ 车间和区域是否正确分列
- ✅ 维修人分类是否正确
- ✅ 时间计算是否准确
- ✅ 有效数据率是否满意

### 第六步：导出数据

#### 导出格式选择

系统支持三种导出格式：

**1. Excel格式 (.xlsx)** - 推荐
- ✅ 保留完整格式
- ✅ 支持公式和样式
- ✅ 可直接在Excel中编辑
- 📊 适合进一步分析和报表

**2. CSV格式 (.csv)**
- ✅ 纯文本格式
- ✅ 最佳兼容性
- ✅ 文件小，易传输
- 📊 适合导入其他系统

**3. JSON格式 (.json)**
- ✅ 结构化数据
- ✅ 便于程序处理
- ✅ 支持嵌套结构
- 📊 适合开发和API

#### 导出步骤

1. 选择导出格式（点击对应按钮）
2. 系统自动生成文件
3. 文件自动下载到浏览器默认下载目录

#### 文件命名

导出的文件默认命名为：
- Excel: `整理后数据_YYYYMMDD_HHMMSS.xlsx`
- CSV: `整理后数据_YYYYMMDD_HHMMSS.csv`
- JSON: `整理后数据_YYYYMMDD_HHMMSS.json`

示例: `整理后数据_20240101_143022.xlsx`

#### 打开导出的文件

**Excel文件**:
- 直接双击打开
- 在Excel中查看和编辑

**CSV文件**:
- 方式1: 在Excel中选择"数据" → "从文本/CSV"
- 方式2: 使用文本编辑器查看
- 注意: 避免直接双击，可能出现乱码

**JSON文件**:
- 使用文本编辑器查看
- 使用在线JSON查看器
- 在程序中读取和处理

## 高级功能

### 批量处理

如果需要处理多个文件：
1. 处理第一个文件
2. 导出结果
3. 点击"重新开始"按钮
4. 上传下一个文件
5. 重复以上步骤

### 数据对比

处理前后数据对比：
1. 导出处理后的数据
2. 在Excel中同时打开原始文件和处理后文件
3. 使用Excel的对比功能

## 常见使用场景

### 场景1: 日常数据整理

**目标**: 每日整理维修记录

**步骤**:
1. 从系统导出当日维修记录(Excel)
2. 上传到本系统
3. 自动处理
4. 导出Excel格式
5. 归档保存

### 场景2: 月度统计报表

**目标**: 生成月度统计报表

**步骤**:
1. 汇总本月所有维修记录
2. 上传到系统处理
3. 查看处理统计
4. 导出Excel格式
5. 使用Excel生成统计图表

### 场景3: 数据迁移

**目标**: 将数据导入其他系统

**步骤**:
1. 上传Excel文件
2. 处理数据
3. 导出CSV或JSON格式
4. 导入目标系统

## 最佳实践

### 数据准备

✅ **推荐做法**:
- 使用标准的Excel模板
- 确保列名一致
- 使用统一的日期格式
- 定期备份原始数据

❌ **避免**:
- 使用合并单元格
- 在数据中插入汇总行
- 使用不标准的日期格式
- 在数据表中添加图片

### 使用习惯

✅ **推荐**:
- 先预览再处理
- 检查验证结果
- 核对处理统计
- 定期导出备份

❌ **避免**:
- 跳过验证步骤
- 忽略警告信息
- 不检查处理结果
- 处理未备份的数据

## 故障排除

### 常见问题

参见 [FAQ](FAQ) 页面获取详细解答。

**快速诊断**:
- 文件无法上传 → 检查格式和大小
- 验证失败 → 检查必需列
- 处理错误 → 查看错误消息
- 导出失败 → 检查浏览器权限

## 获取帮助

如果遇到问题：

1. 📖 查看 [FAQ](FAQ)
2. 🔍 搜索 [Issues](https://github.com/qq940500529/Equipment-Fault-Statistics/issues)
3. 💬 在 [Discussions](https://github.com/qq940500529/Equipment-Fault-Statistics/discussions) 提问
4. 🐛 报告新问题

## 相关文档

- [快速开始](快速开始) - 5分钟快速入门
- [数据结构](数据结构) - 数据格式详解
- [维修人员名单](维修人员名单) - 人员分类名单
- [FAQ](FAQ) - 常见问题解答
